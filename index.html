<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Liquid Interaction</title>
    <script src="https://unpkg.com/matter-js@0.19.0/build/matter.min.js"></script>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            background: #000; 
            height: 100vh;
        }
        /* 這是讓球體變液體的關鍵：如果沒這段，就只是垃圾圓圈 */
        .gooey-layer {
            filter: blur(15px) contrast(30);
            background: #000;
            width: 100%;
            height: 100%;
        }
        canvas { 
            display: block; 
        }
        .instruction {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-family: sans-serif;
            pointer-events: none;
            z-index: 10;
        }
    </style>
</head>
<body>

    <div class="instruction">用滑鼠瘋狂攪動看看</div>
    
    <div class="gooey-layer" id="canvas-container"></div>

    <script>
        // 確保引擎加載後才執行
        window.onload = () => {
            const { Engine, Render, Runner, World, Bodies, MouseConstraint, Mouse } = Matter;

            const engine = Engine.create();
            const container = document.getElementById('canvas-container');
            
            const render = Render.create({
                element: container,
                engine: engine,
                options: {
                    width: window.innerWidth,
                    height: window.innerHeight,
                    wireframes: false,
                    background: 'transparent'
                }
            });

            // 產生 50 顆會互相黏合的液態粒子
            const particles = [];
            for (let i = 0; i < 50; i++) {
                particles.push(Bodies.circle(
                    Math.random() * window.innerWidth, 
                    Math.random() * window.innerHeight, 
                    20, 
                    {
                        render: { fillStyle: '#fff' },
                        friction: 0.01,
                        restitution: 0.8
                    }
                ));
            }

            // 邊界：防止液體流出螢幕
            const offset = 25;
            World.add(engine.world, [
                ...particles,
                Bodies.rectangle(window.innerWidth/2, -offset, window.innerWidth, 50, { isStatic: true }),
                Bodies.rectangle(window.innerWidth/2, window.innerHeight+offset, window.innerWidth, 50, { isStatic: true }),
                Bodies.rectangle(window.innerWidth+offset, window.innerHeight/2, 50, window.innerHeight, { isStatic: true }),
                Bodies.rectangle(-offset, window.innerHeight/2, 50, window.innerHeight, { isStatic: true })
            ]);

            // 加入滑鼠控制
            const mouse = Mouse.create(render.canvas);
            const mouseConstraint = MouseConstraint.create(engine, {
                mouse: mouse,
                constraint: { stiffness: 0.1, render: { visible: false } }
            });

            World.add(engine.world, mouseConstraint);
            Runner.run(engine);
            Render.run(render);
        };
    </script>
</body>
</html>
